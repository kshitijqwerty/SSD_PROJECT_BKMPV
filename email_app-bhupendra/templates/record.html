<html>
  <head>
    <title>Video Live Stream</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <link rel="stylesheet" href="http://horz.ydns.eu:81/style.css">
    
  </head>
  <body>
    <h1>Task Preview</h1>
    <img src="{% url 'video_feed' %}">
    
        <button class="button-21" type='button'id="but1" onclick="capture_toggle()" >Record</button>
    <div id="1" style="display: none">
      <video id="vid" controls >
        <source id="ch_src" src="{% url 'saved_vid' %}" type='video/mp4'/>
      </video>
    </div>
    <div id="2" style="display: none">
      <button class="button-21" type='button'id="but2" onclick="play_pause()" >Pause</button>
    </div>
    <script type="text/javascript">
      //  
      function capture_toggle() {
        elem = document.getElementById("but1");
        div2 = document.getElementById("2");
        div1 = document.getElementById("1");
      $.ajax({
        method: "POST",
        url: "{% url 'toggle' %}",
        data: {
          'csrfmiddlewaretoken': '{{ csrf_token }}',
        },
        success: function(data) {
          if (elem.innerHTML=="Record"){
            elem.innerHTML = "Stop Recording";
            div2.style.display="inline"
            div1.style.display="none"
          } 
          else{
            elem.innerHTML = "Record";
            document.getElementById("vid").load();
            div2.style.display="none"
            div1.style.display="inline"
          } 
        },
        error: function (response) {
                alert(response);
            }
      })
    };

    function play_pause(){
      but2 = document.getElementById("but2");
      div1 = document.getElementById("but1");
      $.ajax({
        method: "POST",
        url: "{% url 'pause_vid' %}",
        data: {
          'csrfmiddlewaretoken': '{{ csrf_token }}',
        },
        success: function(data) {
          if (but2.innerHTML=="Pause"){
            but2.innerHTML = "Resume";
            div1.style.display="none"
          } 
          else{
            but2.innerHTML = "Pause";
            div1.style.display="inline"
          } 
        },
        error: function (response) {
                alert(response);
            }
      })
    };
    </script>
  </body>
 
</html>